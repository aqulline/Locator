#:import sm kivy.uix.screenmanager
ScreenManager:
    id:manager
    transition:sm.FadeTransition(duration=.0)
    MDScreen:
        name:"home"
        FloatLayout:
            Deco:
                md_bg_color:36/255, 146/255, 255/255, 1
                pos_hint:{"center_x":.5,"center_y":1}
            MDLabel:
                text:"current location"
                halign:"center"
                font_style:"Caption"
                pos_hint:{"center_x":.2, "center_y":.95}
                #font_name:'components/fonts/Gill Sans.otf'

            MDIcon:
                halign:"center"
                icon:"weather-sunny"
                pos_hint:{"center_x":.8, "center_y":.93}

            MDIcon:
                halign:"center"
                icon:"google-maps"
                pos_hint:{"center_x":.1, "center_y":.89}
            MDLabel:
                text:app.city
                halign:"center"
                font_style:"H6"
                pos_hint:{"center_x":.3, "center_y":.89}
                font_name:'components/fonts/Gill Sans.otf'
            MDIcon:
                halign:"center"
                icon:app.w_icon1
                font_size:sp(50)
                pos_hint:{"center_x":.8, "center_y":.89}
            MDIcon:
                halign:"center"
                icon:app.w_icon2
                font_size:sp(50)
                pos_hint:{"center_x":.84, "center_y":.89}
            MDIcon:
                halign:"center"
                icon:"temperature-celsius"
                pos_hint:{"center_x":.89, "center_y":.89}
            Foods:
                pos_hint:{"center_x":.25, "center_y":.65}
                on_release:
                    app.screen_capture("s_location")
                    app.bus_station()
                Image:
                    source:"components/icons/lock.png"
                    size_hint:None, None
                    pos_hint:{"center_x":.5, "center_y":.5}
                    size:120, 120

                MDLabel:
                    text:"Search for bus stops near me"
                    halign:"center"
                    font_name:'components/fonts/Gill Sans.otf'

            Foods:
                pos_hint:{"center_x":.75, "center_y":.65}
                on_release:
                    app.screen_capture("bus_location")
                Image:
                    source:"components/icons/lock.png"
                    size_hint:None, None
                    pos_hint:{"center_x":.5, "center_y":.5}
                    size:120, 120

                MDLabel:
                    text:"Search for buses between two location"
                    halign:"center"
                    font_name:'components/fonts/Gill Sans.otf'
            Foods:
                pos_hint:{"center_x":.25, "center_y":.40}
                on_release:
                    app.screen_capture("my_loc")
                Image:
                    source:"components/icons/lock.png"
                    size_hint:None, None
                    pos_hint:{"center_x":.5, "center_y":.5}
                    size:120, 120

                MDLabel:
                    text:"My location"
                    halign:"center"
                    font_name:'components/fonts/Gill Sans.otf'
            Foods:
                pos_hint:{"center_x":.75, "center_y":.40}
                Image:
                    source:"components/icons/lock.png"
                    size_hint:None, None
                    pos_hint:{"center_x":.5, "center_y":.5}
                    size:120, 120

                MDLabel:
                    text:"Track bus by vehicle number"
                    halign:"center"
                    font_name:'components/fonts/Gill Sans.otf'
            Foods:
                pos_hint:{"center_x":.25, "center_y":.15}
                on_release:
                    app.screen_capture("emergency")
                Image:
                    source:"components/icons/lock.png"
                    size_hint:None, None
                    pos_hint:{"center_x":.5, "center_y":.5}
                    size:120, 120

                MDLabel:
                    text:"Emergency!"
                    halign:"center"
                    font_name:'components/fonts/Gill Sans.otf'
            Foods:
                pos_hint:{"center_x":.75, "center_y":.15}
                Image:
                    source:"components/icons/lock.png"
                    size_hint:None, None
                    pos_hint:{"center_x":.5, "center_y":.5}
                    size:120, 120

                MDLabel:
                    text:"My favourite"
                    halign:"center"
                    font_name:'components/fonts/Gill Sans.otf'


    MDScreen:
        name:"s_location"
        FloatLayout:
            orientation:"vertical"
            Deco:
                md_bg_color:36/255, 146/255, 255/255, 1
                pos_hint:{"center_x":.5,"center_y":1}
            MDIcon:
                icon:"google-maps"
                pos_hint:{"center_x":.55,"center_y":.9}

            MDLabel:
                text:"Bus Stations near you!"
                halign:"center"
                font_name:'components/fonts/Gill Sans.otf'
                pos_hint:{"center_x":.3,"center_y":.9}

            RecycleView:
                id: customer
                key_viewclass: 'viewclass'
                key_size: 'height'
                pos_hint:{"top":.8}
                RecycleBoxLayout:
                    id:wali
                    spacing:dp(1)
                    padding: dp(10)
                    default_size: None, dp(55)
                    default_size_hint: 1, None
                    size_hint_y: None
                    height: self.minimum_height
                    orientation: 'vertical'
            MDBoxLayout:
                size:dp(50),dp(50)
                adaptive_height:True
                orientation:"vertical"
                pos_hint:{"top":.1}
                MDRaisedButton:
                    text: "View all in the map"
                    pos_hint:{'center_x': .5, 'center_y': .1}
                    font_size: "18sp"
                    font_name: 'components/fonts/Gill Sans.otf'
                    md_bg_color: 36/255, 146/255, 255/255, 1
                    on_release:
                        app.screen_capture("map")
    MDScreen:
        name:"bus_location"
        FloatLayout:
            MDLabel:
                text:"Search Buses"
                halign:"center"
                font_style:"H6"
                pos_hint:{"center_x":.2, "center_y":.95}
                font_name: 'components/fonts/Gill Sans.otf'

            MDLabel:
                text:"From:"
                halign:"center"
                pos_hint:{"center_x":.2, "center_y":.85}

            MDDropDownItem:
                md_bg_color:36/255, 146/255, 255/255, 1
                pos_hint: {'center_x': .5, 'center_y': .85}
                text: app.city

            MDDropDownItem:
                md_bg_color:36/255, 146/255, 255/255, 1
                pos_hint: {'center_x': .5, 'center_y': .78}
                text: app.location_name_to
                on_release:
                    app.category_sheet(app.regions, "to")

            MDLabel:
                text:"To:"
                halign:"center"
                pos_hint:{"center_x":.2, "center_y":.78}

            RecycleView:
                id: bus_data
                key_viewclass: 'viewclass'
                key_size: 'height'
                pos_hint:{"center_x":.5,"center_y":.5}
                pos_hint:{"top":.7}
                RecycleBoxLayout:
                    spacing:dp(10)
                    padding: dp(10)
                    default_size: None, dp(200)
                    default_size_hint: 1, None
                    size_hint_y: None
                    height: self.minimum_height
                    adaptive_height:True
                    orientation: 'vertical'

            MDRaisedButton:
                text: "Search Bus"
                pos_hint:{'center_x': .5, 'center_y': .1}
                font_size: "18sp"
                font_name: 'components/fonts/Gill Sans.otf'
                md_bg_color: 36/255, 146/255, 255/255, 1
                on_release:
                    app.get_list(app.location_name_to)

            MDSeparator:
                pos_hint:{"center_x":.5, "center_y":.72}


    MDScreen:
        name:"map"
        MDBoxLayout:
            orientation:"vertical"
            MDBoxLayout:
                MapView:
                    id:map
                    #pos_hint:{"center_x":.5, "center_y":.5}
                    lat: app.lat
                    lon: app.lon
                    zoom: app.zoom
                    MapMarkerPopup:
                        source:"components/icons/user.png"
                        lat: app.lat
                        lon: app.lon
                        MDRaisedButton:
                            text:"My Location"
            MDBoxLayout:
                orientation:"vertical"
                RecycleView:
                    id: customers
                    key_viewclass: 'viewclass'
                    key_size: 'height'
                    pos_hint:{"center_x":.5,"center_y":.5}
                    RecycleBoxLayout:
                        id:wali
                        spacing:dp(1)
                        padding: dp(10)
                        default_size: None, dp(55)
                        default_size_hint: 1, None
                        size_hint_y: None
                        height: self.minimum_height
                        orientation: 'vertical'
                MDBoxLayout:
                    size:dp(50),dp(50)
                    adaptive_height:True
                    pos_hint:{"top":.9}
                    MDIconButton:
                        icon:"plus"
                        pos_hint:{"center_x":.4,"center_y":.5}
                        on_release:
                            app.zoom = app.zoom + 2
                    MDLabel:
                        text:str(app.zoom)
                        font_name: 'components/fonts/Gill Sans.otf'
                        font_size: "18sp"
                        halign:"center"
                        pos_hint:{"center_x":.5,"center_y":.5}
                    MDIconButton:
                        icon:"minus"
                        pos_hint:{"center_x":.7,"center_y":.5}
                        on_release:
                            app.zoom = app.zoom - 2

    MDScreen:
        name:"my_loc"
        FloatLayout:
            MDIconButton:
                icon:"crosshairs-gps"
                pos_hint:{"center_x":.5,"center_y":.9}
                user_font_size:"55sp"
                theme_text_color: "Custom"
                md_bg_color:.35, .35, .35, 1
                text_color: 36/255, 146/255, 255/255, 1
                on_release:
                    app.fetch_location()
            MDLabel:
                font_style:"Caption"
                text:"My Location"
                halign:"center"
                pos_hint:{"center_x":.5,"center_y":.83}
                font_name: 'components/fonts/Gill Sans.otf'
            Deco:
                pos_hint:{"center_x":.5,"center_y":.5}
                md_bg_color: .35, .35, .35, 1
                elevation: 7
                size: app.size_x/1.2, app.size_y/2.2
            MDSeparator:
                pos_hint:{"center_x":.45,"center_y":.5}
                orientation:"vertical"
                width:dp(1)
                size_hint: None, .35
                color:150/255, 111/255, 51/255, 1
            MDLabel:
                text:"City:"
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.18,"center_y":.67}
            MDLabel:
                text:"Region:"
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.2,"center_y":.6}
            MDLabel:
                text:"City-district:"
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.243,"center_y":.53}
            MDLabel:
                text:"Sub-ward:"
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.224,"center_y":.46}
            MDLabel:
                text:"Sub-urb:"
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.21,"center_y":.39}
            MDLabel:
                text:"Road:"
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.18,"center_y":.32}
            MDLabel:
                text:app.city
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.7,"center_y":.67}
            MDLabel:
                text:app.region
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.7,"center_y":.6}
            MDLabel:
                text:app.city_district
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.7,"center_y":.53}
            MDLabel:
                text:app.sub_ward
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.7,"center_y":.46}
            MDLabel:
                text:app.sub_urb
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.7,"center_y":.39}
            MDLabel:
                text:app.road
                halign:"center"
                font_size: "20sp"
                theme_text_color: "Custom"
                font_name: 'components/fonts/Gill Sans.otf'
                text_color: 1, 1, 1, 1
                pos_hint:{"center_x":.7,"center_y":.32}
            MDIconButton:
                icon:"share"
                pos_hint:{"center_x":.6,"center_y":.22}
                user_font_size:"30sp"
                md_bg_color: .35, .35, .35, 1
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_release:
                    app.screen_capture("share")
            MDIconButton:
                icon:"map-marker-radius"
                pos_hint:{"center_x":.4,"center_y":.22}
                user_font_size:"30sp"
                md_bg_color: .35, .35, .35, 1
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
                on_release:
                    app.screen_capture("map_loc")


    MDScreen:
        name:"share"
        FloatLayout:
            MDTextField:
                id:username
                mode: "rectangle"
                #fill_color: 0, 0, 0, .4
                size_hint: .6, .1
                pos_hint:{'center_x':.5, 'center_y':.8}
                hint_text:"Share, phone number"
                #text_color: 1, 1, 1, 1
                font_size: dp(25)
            Deco:
                pos_hint:{"center_x":.5,"center_y":.6}
                md_bg_color: .35, .35, .35, 1
                elevation: 7
                size: app.size_x/1.2, app.size_y/7
                MDLabel:
                    text:app.address
                    halign:"center"
                    font_size: "20sp"
                    theme_text_color: "Custom"
                    font_name: 'components/fonts/Gill Sans.otf'
                    text_color: 1, 1, 1, 1
                    pos_hint:{"center_x":.5,"center_y":.5}

            MDRaisedButton:
                text: "Send"
                pos_hint:{'center_x': .5, 'center_y': .45}
                font_size: "18sp"
                font_name: 'components/fonts/Gill Sans.otf'
                md_bg_color: 36/255, 146/255, 255/255, 1
                on_release:
                    app.send_txt(username.text, app.address)



    MDScreen:
        name:"map_loc"
        MDBoxLayout:
            orientation:"vertical"
            MDBoxLayout:
                MapView:
                    id:myap
                    #pos_hint:{"center_x":.5, "center_y":.5}
                    lat: app.lat
                    lon: app.lon
                    zoom: app.zoom
                    MapMarkerPopup:
                        source:"components/icons/user.png"
                        lat: app.lat
                        lon: app.lon
                        MDRaisedButton:
                            text:"My Location"
            MDBoxLayout:
                adaptive_height:True
                md_bg_color:.1,.1,.2,.1
                pos_hint:{"center_x":.5,"top":.8}
                MDIconButton:
                    icon:"plus"
                    pos_hint:{"center_x":.4,"center_y":.5}
                    on_release:
                        app.zoom = app.zoom + 2

                MDLabel:
                    text:"Zoom:"+str(app.zoom)
                    font_name: 'components/fonts/Gill Sans.otf'
                    font_size: "18sp"
                    halign:"center"
                    pos_hint:{"center_x":.5,"center_y":.5}
                MDIconButton:
                    icon:"minus"
                    pos_hint:{"center_x":.7,"center_y":.5}
                    on_release:
                        app.zoom = app.zoom - 2


    MDScreen:
        name:"gps"
        MDBoxLayout:
            orientation: 'vertical'
            MDLabel:
                text: app.gps_location
            MDLabel:
                text: app.gps_status
            MDBoxLayout:
                size_hint_y: None
                height: '48dp'
                padding: '4dp'
                ToggleButton:
                    text: 'Start' if self.state == 'normal' else 'Stop'
                    on_state:
                        app.start(1000, 0) if self.state == 'down' else \
                        app.stop()




    MDScreen:
        name:"genesis"
        radius: [25, 25, 25, 25]
        md_bg_color:36/255, 146/255, 255/255, 1
        MDBoxLayout:
            orientation:'vertical'
            MDLabel:
                text:'LOCATOR'
                halign:'center'
                bold:True
                size_hint:None, None
                font_style:'H3'
                size_hint:1, 5
                font_name:'components/fonts/Gill Sans Bold.otf'
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1
            MDSpinner:
                id:spine
                size_hint: None, None
                size: dp(50), dp(50)
                pos_hint: {'center_x': .5, 'center_y': 1}
                active: True
                color: 1,1,1,1
            MDLabel:
                text:'Welcome!'
                halign:'center'
                bold:True
                size_hint:None, None
                font_style:'H6'
                size_hint:1, 5
                font_name:'components/fonts/Gill Sans Bold.otf'
                theme_text_color: "Custom"
                text_color: 1, 1, 1, 1


<DataContainer@MDBoxLayout>:
    size:dp(50),dp(50)
    adaptive_height:True
    orientation:"vertical"
    pos_hint:{"top":.9}
<Details@MDBoxLayout>:
    radius:9
    adaptive_height:True
    md_bg_color:.1,.1,.2,.1
    pos_hint:{"center_x":.5,"top":.8}
    orientation:"vertical"

<Foods@MDCard>:
    orientation: "vertical"
    md_bg_color: 1, 1, 1, 1
    padding: "10dp"
    #spacing: "5dp"
    border_radius: 20
    border_color_a: 0
    radius: [15]
    size_hint: None, None
    size: app.size_x/2.2, app.size_y/4.5
    focus_behavior: False
    ripple_behavior: True
    elevation: 0.1
<RowCard>:
    #orientation: "vertical"
    md_bg_color: 1, 1, 1, 1
    pos_hint:{"center_x":.5,"center_y":.3}
    padding: "10dp"
    #spacing: "5dp"
    border_radius: 3
    border_color_a: .5
    border_color_a: 1
    adaptive_height:True
    radius: [3]
    size_hint: None, None
    size: app.size_x/1.5, app.size_y/11
    focus_behavior: False
    ripple_color:.9, .9, .95, 1
    ripple_behavior: True
    on_release:
        print(self.id)
        app.screen_capture("map")
        app.bus_stop_specific(self.id)
    FloatLayout:
        MDIcon:
            icon:root.icon
            badge_icon:"cat"
            font_size:"30sp"
            theme_text_color:"Custom"
            text_color: 1, .5, .5, 1
            pos_hint:{"center_x":.5,"center_y":.5}
        MDLabel:
            text:root.name
            font_size:"15sp"
            #halign:"center"
            pos_hint:{"center_x":.63,"center_y":.5}

<Deco@MDCard>:
    orientation: "vertical"
    md_bg_color: 1, 1, 1, 1
    padding: "10dp"
    #spacing: "5dp"
    border_radius: 3
    border_color_a: .5
    radius: [9]
    size_hint: None, None
    size: app.size_x/1, app.size_y/2.5
    focus_behavior: False
    ripple_behavior: False

<BusInfo>:
    radius:9
    adaptive_height:True
    height:dp(200)
    md_bg_color:214/255, 223/255, 232/255, 1
    pos_hint:{"center_x":.5,"top":.8}
    orientation:"vertical"
    FloatLayout:
        MDLabel:
            text:root.name
            halign:"center"
            font_size:"20sp"
            theme_text_color: "Custom"
            text_color:26/255, 54/255, 113/255
            pos_hint:{"center_x":.2,"center_y":.8}
        MDLabel:
            text:root.route
            halign:"center"
            theme_text_color: "Custom"
            text_color:26/255, 54/255, 113/255, 1
            pos_hint:{"center_x":.4,"center_y":.6}
        MDLabel:
            text:root.lcn
            halign:"center"
            theme_text_color: "Custom"
            text_color:70/255, 69/255, 79/255, 1
            pos_hint:{"center_x":.25,"center_y":.4}
        MDLabel:
            text:root.price
            halign:"center"
            theme_text_color: "Custom"
            text_color:235/255, 115/255, 115/255, 1
            pos_hint:{"center_x":.8,"center_y":.18}
        MDLabel:
            text:root.seats
            halign:"center"
            theme_text_color: "Custom"
            text_color:70/255, 69/255, 79/255, 1
            font_size:"15sp"
            theme_text_color: "Custom"
            pos_hint:{"center_x":.8,"center_y":.4}
        MDRaisedButton:
            text: "View Details"
            size_hint: .3, .2
            elevation:9
            #font_size: "29sp"
            pos_hint:{'center_x':.2, 'center_y':.19}
            md_bg_color: 26/255, 54/255, 113/255, 1